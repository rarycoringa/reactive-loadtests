import random
import uuid

from locust import HttpUser, task, between


available_products = [
    "693588e037df55e061dcb340", "693588f037df55e061dcb341", "693588fa37df55e061dcb342",
    "693a3e4535346020a1a211e9", "693a4d8598984e43b714d3e3", "693a4d8598984e43b714d3e4",
    "693a4d8698984e43b714d3e5", "693a4d8798984e43b714d3e6", "693a4d8898984e43b714d3e7",
    "693a4d8998984e43b714d3e8", "693a4d8a98984e43b714d3e9", "693a4d8b98984e43b714d3ea",
    "693a4d8b98984e43b714d3eb", "693a4d8c98984e43b714d3ec", "693a4d8d98984e43b714d3ed",
    "693a4d8d98984e43b714d3ee", "693a4d8e98984e43b714d3ef", "693a4d8f98984e43b714d3f0",
    "693a4d9098984e43b714d3f1", "693a4e1698984e43b714d3f2", "693a4e1698984e43b714d3f4",
    "693a4e1698984e43b714d3f5", "693a4e1698984e43b714d3f6", "693a4e1698984e43b714d3f8",
    "693a4e1698984e43b714d3f9", "693a4e1698984e43b714d3fa", "693a4e1698984e43b714d3f3",
    "693a4e1698984e43b714d3fb", "693a4e1698984e43b714d3f7", "693a4e1698984e43b714d3fc",
    "693a4e1698984e43b714d3fd", "693a4e1698984e43b714d3fe", "693a4e1698984e43b714d3ff",
    "693a4e1698984e43b714d400", "693a4e1698984e43b714d401", "693a4e1698984e43b714d402",
    "693a4e1698984e43b714d403", "693a4e1698984e43b714d404", "693a4e1698984e43b714d405",
    "693a4e1698984e43b714d406", "693a4e1698984e43b714d407", "693a4e1698984e43b714d408",
    "693a4e1698984e43b714d409", "693a4e1698984e43b714d40a", "693a4e1698984e43b714d40b",
    "693a4e1698984e43b714d40d", "693a4e1698984e43b714d40c", "693a4e1698984e43b714d40e",
    "693a4e1698984e43b714d40f", "693a4e1698984e43b714d410", "693a4e1698984e43b714d411",
    "693a4e1698984e43b714d412", "693a4e1698984e43b714d413", "693a4e1698984e43b714d414",
    "693a4e1698984e43b714d415", "693a4e1698984e43b714d416", "693a4e1698984e43b714d417",
    "693a4e1698984e43b714d418", "693a4e1698984e43b714d419", "693a4e1698984e43b714d41a",
    "693a4e1698984e43b714d41b", "693a4e1698984e43b714d41c", "693a4e1698984e43b714d41d",
    "693a4e1698984e43b714d41e", "693a4e1698984e43b714d41f", "693a4e1698984e43b714d420",
    "693a4e1698984e43b714d421", "693a4e1698984e43b714d422", "693a4e1698984e43b714d423",
    "693a4e1698984e43b714d424", "693a4e1698984e43b714d425", "693a4e1698984e43b714d426",
    "693a4e1698984e43b714d427", "693a4e1698984e43b714d428", "693a4e1698984e43b714d429",
    "693a4e1698984e43b714d42a", "693a4e1698984e43b714d42b", "693a4e1698984e43b714d42c",
    "693a4e1698984e43b714d42d", "693a4e1698984e43b714d42e", "693a4e1698984e43b714d42f",
    "693a4e1698984e43b714d430", "693a4e1698984e43b714d431", "693a4e1698984e43b714d432",
    "693a4e1698984e43b714d433", "693a4e1698984e43b714d434", "693a4e1698984e43b714d435",
    "693a4e1698984e43b714d436", "693a4e1698984e43b714d437", "693a4e1698984e43b714d438",
    "693a4e1698984e43b714d439", "693a4e1698984e43b714d43a", "693a4e1698984e43b714d43b",
    "693a4e1698984e43b714d43c", "693a4e1698984e43b714d43d", "693a4e1698984e43b714d43e",
    "693a4e1698984e43b714d43f", "693a4e1698984e43b714d440", "693a4e1698984e43b714d441",
    "693a4e1698984e43b714d442", "693a4e1698984e43b714d443", "693a4e1698984e43b714d444",
    "693a4e1698984e43b714d445", "693a4e1698984e43b714d446", "693a4e1698984e43b714d447",
    "693a4e1698984e43b714d448", "693a4e1698984e43b714d449", "693a4e1698984e43b714d44a",
    "693a4e1698984e43b714d44b", "693a4e1698984e43b714d44c", "693a4e1698984e43b714d44d",
    "693a4e1698984e43b714d44e", "693a4e1698984e43b714d44f", "693a4e1698984e43b714d450",
    "693a4e1698984e43b714d451", "693a4e1698984e43b714d452", "693a4e1698984e43b714d453",
    "693a4e1698984e43b714d454", "693a4e1698984e43b714d455", "693a4ebdb30ba91048c26859",
]

uk_cities = [
    "London", "Manchester", "Birmingham", "Liverpool",
    "Leeds", "Bristol", "Edinburgh", "Glasgow",
    "Sheffield", "Cardiff", "Belfast", "Newcastle",
    "Nottingham", "Southampton", "Brighton", "Cambridge",
    "Oxford", "York", "Bath", "Durham",]


class WebFluxAPIUser(HttpUser):
    wait_time = between(0.1, 0.5)

    @task(3)
    def create_order(self):
        endpoint = "/order/orders"
        headers = {"Content-Type": "application/json"}

        product_id = random.choice(available_products)
        split_into = random.randint(1, 6)
        card_number = (
            f"{random.randint(1000, 9999)}"
            f" {random.randint(1000, 9999)}"
            f" {random.randint(1000, 9999)}"
            f" {random.randint(1000, 9999)}"
        )
        address = f"{random.choice(uk_cities)}, UK"

        payload = {
            "product_id": product_id,
            "product_quantity": 0,
            "split_into": split_into,
            "card_number": card_number,
            "address": address,
        }

        with self.client.post(
            endpoint,
            json=payload,
            headers=headers,
            catch_response=True,
        ) as response:
            if response.status_code != 200:
                response.failure(f"Unexpected status {response.status_code}")
